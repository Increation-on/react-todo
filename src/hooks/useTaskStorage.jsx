import { useEffect } from "react"

export const useTaskStorage = (tasks, setTasks) => {
    // üéØ –≠—Ñ—Ñ–µ–∫—Ç –¥–ª—è –ó–ê–ì–†–£–ó–ö–ò –∑–∞–¥–∞—á –∏–∑ localStorage
    // –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ (—Ç.–∫. [setTasks] —Å—Ç–∞–±–∏–ª—å–Ω–∞)
    useEffect(() => {
        const saved = localStorage.getItem('tasks') // ‚¨ÖÔ∏è –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
        if (saved && saved !== '[]') { // ‚¨ÖÔ∏è –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –µ—Å—Ç—å –∏ –Ω–µ –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤
            const parsed = JSON.parse(saved) // ‚¨ÖÔ∏è –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º JSON —Å—Ç—Ä–æ–∫—É –≤ –º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤
            setTasks(parsed) // ‚¨ÖÔ∏è –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–¥–∞—á–∏ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        }
    }, [setTasks]) // ‚¨ÖÔ∏è –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å: setTasks (—Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è)

    // üéØ –≠—Ñ—Ñ–µ–∫—Ç –¥–ª—è –°–û–•–†–ê–ù–ï–ù–ò–Ø –∑–∞–¥–∞—á –≤ localStorage  
    // –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ tasks
    useEffect(() => {
        localStorage.setItem('tasks', JSON.stringify(tasks)) // ‚¨ÖÔ∏è –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–∞–∫ JSON —Å—Ç—Ä–æ–∫—É
    }, [tasks]) // ‚¨ÖÔ∏è –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å: tasks (–º–∞—Å—Å–∏–≤ –∑–∞–¥–∞—á)
}

// ‚ö†Ô∏è OPTIMIZATION: –ü—Ä–∏ –ø–µ—Ä–≤–æ–º —Ä–µ–Ω–¥–µ—Ä–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –¥–≤–æ–π–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞
// - –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ localStorage ‚Üí setTasks()
// - –ò–∑–º–µ–Ω–µ–Ω–∏–µ tasks ‚Üí —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ localStorage
// –í –±—É–¥—É—â–µ–º –º–æ–∂–Ω–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ useRef/isFirstRender